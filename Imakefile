/*
 * Imakefile for Sd (square dance caller's helper)
 * Time-stamp: <93/11/26 16:10:23 gildea>
 *
 * Run "xmkmf" to generate a Makefile from this description.
 * Then run "make" to build the Sd system.
 */

SD_SRCS = sdmain.c sdinit.c sdutil.c sdbasic.c \
          sdtables.c sdctable.c sdtop.c sdconcpt.c sdpreds.c sd12.c sd16.c \
          sdgetout.c sdmoves.c sdtand.c sdconc.c sdistort.c \
          sdsi.c

SD_OBJS = sdmain.o sdinit.o sdutil.o sdbasic.o \
          sdtables.o sdctable.o sdtop.o sdconcpt.o sdpreds.o sd12.o sd16.o \
          sdgetout.o sdmoves.o sdtand.o sdconc.o sdistort.o \
          sdsi.o

SDX11_SRC = sdui-x11.c
SDX11_OBJ = sdui-x11.o

SDTTY_SRC = sdui-tty.c sdmatch.c sdui-ttu.c
SDTTY_OBJ = sdui-tty.o sdmatch.o sdui-ttu.o

MKCALLS_SRCS = mkcalls.c dbcomp.c
MKCALLS_OBJS = mkcalls.o dbcomp.o

SRCS = $(SD_SRCS) $(SDX11_SRC) $(SDTTY_SRC) $(MKCALLS_SRCS)
OBJS = $(SD_OBJS) $(SDX11_OBJ) $(SDTTY_OBJ) $(MKCALLS_OBJS)

/*
 * building the program and database
 */

AllTarget(sd sd_calls.dat)
allx11: sd sd_calls.dat
alltty: sdtty sd_calls.dat
everything: allx11 alltty

NormalProgramTarget(sd,$(SD_OBJS) $(SDX11_OBJ),XawClientDepLibs,XawClientLibs, /**/)

NormalProgramTarget(mkcalls,$(MKCALLS_OBJS), /**/, /**/, /**/)

#if defined(SunArchitecture) && OSMajorVersion < 5
CURSES_LIB = -L/usr/5lib
TTY_FLAGS = -I/usr/5include
#endif
CURSES = $(CURSES_LIB) -lcurses

SpecialObjectRule(sdui-ttu.o, /**/,$(TTY_FLAGS))

NormalProgramTarget(sdtty,$(SD_OBJS) $(SDTTY_OBJ), /**/, /**/,$(CURSES))

sd_calls.dat: sd_calls.txt mkcalls
	./mkcalls

/*
 * printing the documenmtation
 */

info: sd_doc.info
dvi: sd_doc.dvi
ps: sd_doc.ps

sd_doc.dvi sd_doc.info sd_doc.txt: sd_doc.txinfo readme.txinfo install.txinfo

.SUFFIXES: .dvi .info .txt .txinfo

MAKEINFO = makeinfo --no-split
MAKE_ASCII = $(MAKEINFO) --no-headers
TXI2DVI = tex
DVIPS = dvips

.txinfo.dvi:
	$(TXI2DVI) $<

.txinfo.info:
	$(MAKEINFO) $<

.txinfo.txt:
	$(MAKE_ASCII) -o $@ $<

sd_doc.ps: sd_doc.dvi
	$(DVIPS) -o $@ $?

INSTALL: install.txinfo
	$(MAKE_ASCII) -o $@ --no-validate $(srcdir)/install.txinfo

README: readme.txinfo
	$(MAKE_ASCII) -o $@ --no-validate $(srcdir)/readme.txinfo

/*
 * miscellaneous
 */

docclean:
	$(RM) *.aux *.log *.toc *.dvi
	$(RM) *.cp *.cps *.fn *.fns *.ky *.kys *.pg *.pgs *.tp *.tps *.vr *.vrs

clean:: docclean
clean::
	$(RM) sd_calls.dat sd.tar sd.tar.Z
	$(RM) lint.out

distclean: clean
	$(RM) sequence.*

realclean: distclean
	$(RM) *.info *.PS sd_doc.txt sd_doc.ps

DependTarget()			
